<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>地址公园管理后台</title>
    <link rel="stylesheet" href="/plugins/layui/css/layui.css">
</head>
<body class="layui-layout-body">

<div class="layui-layout layui-layout-admin">

    <script type="text/javascript" src="/view/layout/header.js"></script>
    <script type="text/javascript" src="/view/layout/side.js"></script>

    <div class="layui-body">
        <div style="padding: 15px;">
            内容主体区域
        </div>
    </div>

    <script type="text/javascript" src="/view/layout/footer.js"></script>

</div>

<script type="text/javascript" src="/view/layout/scripts.js"></script>

<script>
    layui.use('element', function(){
        var element = layui.element;

    });
</script>



<script>
    layui.use(['form', 'table', 'lichee'], function () {
        var table = layui.table;
        var layer = layui.layer;
        var lichee = layui.lichee;


        // 渲染表格
        var resourceTable = table.render({
            elem: '#resource-table',
            toolbar: '#resource-toolbar',
            url: config.serverUrl + '/resources',
            request: config.request,
            parseData: config.parseData,
            response: config.response,
            headers: {Authorization: config.getToken()},
            page: true,
            cols: [[
                {field: 'id', title: 'ID'},
                {field: 'resourceName', align: 'center', sort: true, title: '资源名称'},
                {field: 'method', align: 'center', sort: true, title: '请求方式'},
                {field: 'mapping', align: 'center', sort: true, title: '路径映射'},
                {
                    minWidth: 80, align: 'center', templet: function (d) {
                        if (d.authType == 1) {
                            return '<span class="layui-badge layui-bg-blue">需要登录</span>';
                        } else if (d.authType == 2) {
                            return '<span class="layui-badge layui-bg-green">无需鉴权</span>';
                        } else if (d.authType == 3) {
                            return '<span class="layui-badge layui-bg-red">需要鉴权</span>';
                        } else {
                            return '<span class="layui-badge layui-bg-gray">未知类型</span>';
                        }
                    }, title: '权限类型'
                },
                {field: 'perm', align: 'center', sort: true, title: '权限标识'},
                {field: 'updateTime', align: 'center', sort: true, title: '修改时间'}
            ]]
        });
        // 表格顶部操作列
        table.on('toolbar(resource-table)', function (obj) {
            if (obj.event === 'refresh') {
                crown.put('/resources', {}, function () {
                    layer.msg('刷新成功', {icon: 1});
                    resourceTable.reload('resource-table', {});
                });
            }
        });
        // 搜索按钮点击事件
        $('#resource-btn-search').click(function () {
            resourceTable.reload({where: crown.getSearchForm()});
        });
    });
</script>
</body>
</html>